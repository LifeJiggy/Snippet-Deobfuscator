{
  "name": "malware-analysis-skill",
  "version": "3.0.0",
  "description": "Advanced malware detection and analysis skill for JavaScript security",
  "type": "skill",
  "category": "security",
  "author": "Deobfuscation Team",
  "license": "MIT",
  "capabilities": {
    "codeInjection": [
      {
        "name": "eval-injection",
        "description": "Detection of eval-based code injection",
        "patterns": ["eval(", "eval.call"],
        "severity": "critical",
        "cwe": "CWE-94"
      },
      {
        "name": "function-constructor",
        "description": "Detection of Function constructor injection",
        "patterns": ["new Function(", "Function("],
        "severity": "critical",
        "cwe": "CWE-94"
      },
      {
        "name": "settimeout-string",
        "description": "Detection of setTimeout/setInterval with string argument",
        "patterns": ["setTimeout(", "setInterval("],
        "severity": "high",
        "cwe": "CWE-95"
      }
    ],
    "dataExfiltration": [
      {
        "name": "network-beacon",
        "description": "Detection of network beaconing behavior",
        "patterns": ["fetch(", "XMLHttpRequest", "WebSocket"],
        "severity": "high",
        "cwe": "CWE-359"
      },
      {
        "name": "credential-harvest",
        "description": "Detection of credential harvesting patterns",
        "patterns": ["password", "credential", "token", "secret"],
        "severity": "critical",
        "cwe": "CWE-200"
      },
      {
        "name": "storage-access",
        "description": "Detection of localStorage/sessionStorage access",
        "patterns": ["localStorage", "sessionStorage", "cookie"],
        "severity": "medium",
        "cwe": "CWE-522"
      }
    ],
    "cryptojacking": [
      {
        "name": "mining-script",
        "description": "Detection of cryptocurrency mining scripts",
        "patterns": ["CoinHive", "cryptonight", "hashrate"],
        "severity": "high",
        "cwe": "CWE-400"
      },
      {
        "name": "webassembly-mining",
        "description": "Detection of WebAssembly-based mining",
        "patterns": ["WebAssembly.instantiate", ".wasm"],
        "severity": "high",
        "cwe": "CWE-400"
      }
    ],
    "redirection": [
      {
        "name": "location-hijack",
        "description": "Detection of location manipulation",
        "patterns": ["location.href", "location.replace"],
        "severity": "high",
        "cwe": "CWE-601"
      },
      {
        "name": "meta-refresh",
        "description": "Detection of meta refresh injection",
        "patterns": ["meta http-equiv", "refresh"],
        "severity": "medium",
        "cwe": "CWE-601"
      }
    ],
    "domManipulation": [
      {
        "name": "xss-injection",
        "description": "Detection of XSS injection patterns",
        "patterns": ["innerHTML", "outerHTML", "document.write"],
        "severity": "critical",
        "cwe": "CWE-79"
      },
      {
        "name": "dom-clobbering",
        "description": "Detection of DOM clobbering attempts",
        "patterns": ["document.getElementById", "window["],
        "severity": "medium",
        "cwe": "CWE-79"
      }
    ],
    "prototypePollution": [
      {
        "name": "proto-pollution",
        "description": "Detection of __proto__ pollution",
        "patterns": ["__proto__", "prototype["],
        "severity": "critical",
        "cwe": "CWE-1321"
      },
      {
        "name": "constructor-pollution",
        "description": "Detection of constructor pollution",
        "patterns": ["constructor.prototype"],
        "severity": "critical",
        "cwe": "CWE-1321"
      }
    ],
    "obfuscation": [
      {
        "name": "packed-code",
        "description": "Detection of packed/encoded code",
        "patterns": ["eval(atob", "eval(String.fromCharCode"],
        "severity": "high",
        "cwe": "CWE-506"
      },
      {
        "name": "self-decoding",
        "description": "Detection of self-decoding functions",
        "patterns": ["function(p,a,c,k,e"],
        "severity": "high",
        "cwe": "CWE-506"
      }
    ]
  },
  "detection": {
    "patterns": {
      "eval": {
        "regex": "\\beval\\s*\\(",
        "context": "call",
        "severity": "critical"
      },
      "functionConstructor": {
        "regex": "\\bFunction\\s*\\(",
        "context": "call",
        "severity": "critical"
      },
      "innerHTML": {
        "regex": "\\.innerHTML\\s*=",
        "context": "assignment",
        "severity": "critical"
      },
      "documentWrite": {
        "regex": "document\\.write\\s*\\(",
        "context": "call",
        "severity": "critical"
      },
      "protoPollution": {
        "regex": "(__proto__|prototype)\\s*\\[",
        "context": "member",
        "severity": "critical"
      },
      "credentialAccess": {
        "regex": "(password|token|secret|api_key|credential)\\s*[=:]]",
        "context": "assignment",
        "severity": "high"
      },
      "networkBeacon": {
        "regex": "(fetch|XMLHttpRequest|WebSocket)\\s*\\(",
        "context": "call",
        "severity": "high"
      },
      "locationHijack": {
        "regex": "location\\.(href|replace|assign)\\s*=",
        "context": "assignment",
        "severity": "high"
      }
    },
    "heuristics": {
      "entropyThreshold": 4.5,
      "maxStringLength": 10000,
      "suspiciousKeywordCount": 3,
      "minObfuscationScore": 0.7
    },
    "validation": {
      "checkContext": true,
      "analyzeDataFlow": true,
      "trackTaintSources": true,
      "detectAnomalies": true
    }
  },
  "analysis": {
    "static": {
      "parseAST": true,
      "detectPatterns": true,
      "analyzeControlFlow": true,
      "checkDataFlow": true
    },
    "dynamic": {
      "simulate": false,
      "trackExecution": false,
      "monitorNetwork": false
    },
    "behavioral": {
      "detectAnomalies": true,
      "compareBaseline": true,
      "flagSuspicious": true
    }
  },
  "scoring": {
    "weights": {
      "critical": 10,
      "high": 7,
      "medium": 4,
      "low": 1
    },
    "thresholds": {
      "malicious": 15,
      "suspicious": 8,
      "benign": 0
    }
  },
  "configuration": {
    "strictMode": true,
    "verboseLogging": false,
    "timeout": 30000,
    "maxPatterns": 500,
    "reportFormat": "detailed"
  },
  "output": {
    "includePatterns": true,
    "includeLocations": true,
    "includeSeverities": true,
    "includeCWE": true,
    "includeRemediation": true
  },
  "dependencies": {
    "required": ["@babel/parser", "@babel/traverse"],
    "optional": [],
    "version": "Node.js >= 14.0.0"
  },
  "entry": "malware-analysis.js",
  "priority": 4,
  "timeout": 30000,
  "retries": 3,
  "examples": [
    {
      "input": "eval(atob('Y29uc29sZS5sb2coImhleSIp'))",
      "detected": ["eval-injection", "packed-code"],
      "severity": "critical"
    },
    {
      "input": "document.body.innerHTML = userInput;",
      "detected": ["xss-injection"],
      "severity": "critical"
    }
  ],
  "metadata": {
    "created": "2024-01-01T00:00:00.000Z",
    "updated": "2024-01-15T00:00:00.000Z",
    "tags": ["malware", "security", "xss", "injection", "analysis"],
    "documentation": "./skills/malware-analysis/skills.md"
  }
}
